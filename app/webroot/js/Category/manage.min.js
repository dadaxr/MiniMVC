(function(e){function o(){e("#form_categories").on("submit",function(){f()});r.on("click",function(){var e=t.jqxTree("getSelectedItem");if(!e){return}var r=n.val();t.jqxTree("updateItem",e,{label:r})});i.on("click",function(){var e=t.jqxTree("getSelectedItem");if(!e){return}t.jqxTree("removeItem",e)});s.on("click",function(){var e="Categorie-"+Math.floor(Math.random()*101);t.jqxTree("addTo",{label:e})})}function u(){var r=e("#categories_tree_container").data("categoriesJson");var i={datatype:"json",datafields:[{name:"id",type:"int"},{name:"title",type:"string"},{name:"parent_id",type:"int"},{name:"html_id",type:"string"},{name:"checked",type:"bool"}],id:"id",localdata:r};var s=new e.jqx.dataAdapter(i);s.dataBind();var o=[{name:"title",map:"label"},{name:"checked",map:"checked"},{name:"id",map:"value"},{name:"html_id",map:"id"}];var u=s.getRecordsHierarchy("id","parent_id","items",o);t.on("initialized",function(e){});t.on("select",function(e){var r=t.jqxTree("getSelectedItem");n.val(r.label)});t.jqxTree({source:u,height:"300px",allowDrag:true,theme:"bootstrap"})}function a(){e("#trigger_expand_all").click(function(){t.jqxTree("expandAll")});e("#trigger_collapse_all").click(function(){t.jqxTree("collapseAll")})}function f(){var n=t.jqxTree("getItems");var r,i,s,o,u;var a={"null":0};var f=[];for(var l in n){r=n[l];i=null;if(r.level>0){i=r.parentId.split("_").pop()}s=a[i]++;if(r.value){u=r.value;o=false}else{u=r.id;o=true}f.push({id:u,title:r.label,parent_id:i,order:s,is_new:o})}e("#serialized_categories").val(JSON.stringify(f))}var t=e("#categories_tree_container");var n=e("#ti_category_title");var r=e("#trigger_update_selected");var i=e("#trigger_remove_selected");var s=e("#trigger_add");e(document).ready(function(){o();u();a()})})(jQuery)